/*
 * test_cnn.c
 *
 *  Created on: Feb 2, 2018
 *      Author: xph3sei708
 */

#include <stdio.h>
#include <time.h>
/*
// Bare-minimum start-up code to run NEON code
// Part 2.1.7, p29 of "Neon Programmer's guide.pdf"
__asm void EnableNEON(void){
    MRC p15,0,r0,c1,c0,2
    ORR r0,r0,#0x00f00000

    MCR p15,0,r0,c1,c0,2
    ISB
    MOV r0,#0x40000000
    MSR FPEXC,r0
}*/

int main(int argc, char * argv[]){

const float img[3][32][32]={{{59,43,50,68,98,119,139,145,149,149,131,125,142,144,137,129,137,134,124,139,139,133,136,139,152,163,168,159,158,158,152,148},{16,0,18,51,88,120,128,127,126,116,106,101,105,113,109,112,119,109,105,125,127,122,131,124,121,131,132,133,133,123,119,122},{25,16,49,83,110,129,130,121,113,112,112,106,105,128,124,130,127,122,115,120,130,131,139,127,126,127,130,142,130,118,120,109},{33,38,87,106,115,117,114,105,107,121,125,109,113,146,133,127,118,117,127,122,132,137,136,131,124,130,132,135,130,125,121,94},{50,59,102,127,124,121,120,114,107,125,129,106,108,124,121,108,98,110,117,120,134,140,131,141,135,127,121,119,103,87,75,67},{71,84,110,129,136,131,129,119,108,122,123,105,107,111,108,98,94,97,83,88,102,97,88,118,140,136,120,107,88,67,35,32},{97,111,123,130,136,132,122,121,127,138,124,120,107,80,68,74,101,105,65,58,63,78,136,122,139,151,129,108,95,96,89,66},{115,119,130,140,133,127,138,137,131,133,134,108,72,51,41,72,181,209,125,68,64,82,123,112,135,151,137,114,105,101,126,102},{137,128,132,128,119,123,128,130,121,137,131,74,54,50,44,86,203,217,162,100,77,75,74,76,107,135,135,129,127,119,125,134},{154,154,156,140,123,125,126,127,133,132,90,63,62,70,79,103,152,148,141,121,101,96,86,75,101,136,136,134,133,132,128,133},{154,155,156,147,133,137,139,134,141,121,80,97,90,98,137,139,148,134,138,134,140,175,142,102,108,135,131,133,138,136,130,134},{145,146,146,135,127,129,117,103,130,120,111,146,136,163,169,152,161,148,177,161,195,209,189,125,108,140,137,132,136,133,132,133},{142,141,140,144,147,121,84,88,109,101,138,213,178,191,211,189,205,207,213,191,199,188,161,130,124,131,130,131,134,135,136,133},{158,154,142,143,132,90,72,81,84,107,165,229,183,191,239,219,228,225,214,216,210,200,189,174,161,139,134,126,131,142,136,138},{145,149,147,147,136,80,89,105,96,129,192,185,145,203,223,242,244,238,241,227,225,235,219,224,215,156,128,129,131,133,128,130},{148,146,145,147,133,63,66,88,113,182,220,138,162,206,196,247,255,255,245,236,230,215,231,250,241,158,125,126,124,125,126,124},{149,143,144,151,132,64,84,112,163,223,206,145,196,204,220,243,245,239,234,231,195,150,208,250,227,163,145,143,140,136,121,114},{147,134,140,148,135,100,108,144,210,248,175,175,220,226,230,233,224,201,184,181,190,170,179,231,223,162,146,140,139,145,142,128},{152,117,114,123,126,122,93,179,238,248,170,185,241,230,187,180,166,146,149,157,184,216,212,236,236,166,136,134,130,127,137,151},{145,127,128,133,132,135,171,237,252,229,173,169,220,194,123,135,127,151,165,132,151,202,240,240,222,156,119,120,112,100,99,140},{143,127,129,129,130,140,219,244,210,193,166,153,191,179,128,147,149,172,147,128,141,173,202,190,198,152,100,109,119,121,108,136},{143,125,131,128,123,153,148,166,188,182,171,165,195,190,152,143,152,153,142,141,135,136,148,141,141,138,111,111,121,129,138,179},{141,131,139,139,138,151,128,136,175,173,189,205,201,168,151,145,146,149,153,149,144,144,145,143,129,123,124,113,108,113,148,199},{143,139,138,149,160,150,147,151,169,167,179,212,203,207,149,139,144,137,151,155,152,140,107,91,84,105,132,118,96,102,159,190},{149,133,136,147,150,153,157,162,175,190,166,202,224,197,192,180,146,126,141,156,153,115,77,79,93,126,133,119,113,140,187,154},{172,144,135,136,135,139,153,163,166,184,166,150,184,156,158,168,149,135,130,132,128,127,135,143,139,136,127,121,135,189,211,136},{202,187,151,128,122,134,142,150,153,148,135,127,153,166,143,130,128,151,152,135,139,155,161,154,154,143,130,132,171,215,186,117},{216,193,168,151,131,126,138,144,142,137,120,131,145,144,137,127,126,139,153,149,140,135,147,148,149,149,137,143,203,206,124,71},{220,201,186,172,156,142,142,153,150,139,126,136,148,141,131,126,127,138,150,154,149,124,126,141,145,147,127,114,186,173,56,33},{208,201,198,191,183,171,159,147,135,130,139,147,144,145,137,136,137,148,152,150,155,138,120,128,142,135,90,50,137,160,56,53},{180,173,186,194,198,201,189,173,156,139,142,145,141,141,139,140,143,139,138,143,146,135,117,112,122,104,58,34,131,184,97,83},{177,168,179,188,202,218,218,207,191,175,166,163,163,161,153,159,162,149,140,148,161,144,112,119,130,120,92,103,170,216,151,123}},
		{{62,46,48,54,73,91,107,110,117,120,103,99,115,112,105,97,106,106,97,113,112,105,105,108,120,131,136,129,130,132,125,124},{20,0,8,27,51,82,89,86,87,79,70,67,70,74,70,72,79,71,69,89,92,85,89,82,79,89,91,94,96,88,83,87},{24,7,27,50,72,92,93,82,77,78,79,75,73,92,87,92,89,85,79,85,95,96,102,90,89,89,92,105,94,84,84,73},{25,20,54,63,70,74,72,62,68,84,90,75,77,105,91,84,76,76,87,81,92,99,99,93,86,91,90,93,90,87,85,62},{32,32,65,79,77,77,78,74,72,88,89,68,71,83,78,68,65,74,80,80,93,106,95,98,92,84,79,79,67,57,47,42},{48,53,73,82,88,84,84,77,70,82,81,65,72,77,74,65,62,63,56,58,68,69,54,74,96,97,80,68,54,39,10,13},{69,75,85,84,88,83,74,74,83,94,79,79,71,50,43,41,51,56,37,36,37,51,93,68,86,106,87,68,59,63,61,47},{82,76,90,97,88,81,90,89,86,89,91,70,39,26,22,31,102,127,76,40,38,53,77,56,81,103,95,76,69,66,92,74},{100,82,91,87,81,82,85,85,80,97,94,42,25,29,29,39,106,109,90,58,42,43,39,35,67,96,97,91,89,83,86,95},{120,112,114,100,89,86,86,91,97,97,60,35,33,39,50,53,70,64,79,75,58,54,48,38,63,91,92,93,93,93,86,92},{122,117,117,108,100,100,102,102,111,87,40,53,45,56,91,84,87,73,82,85,92,129,99,61,67,90,87,91,97,95,86,93},{114,109,109,97,92,94,84,74,103,83,60,86,78,116,115,100,116,97,121,110,150,167,146,78,63,96,95,93,95,90,87,92},{115,106,105,105,110,89,56,61,80,57,79,150,123,150,169,148,164,162,164,143,158,151,121,83,77,87,91,93,93,91,89,91},{131,119,107,102,92,59,44,52,47,55,106,176,137,158,216,192,188,188,177,174,171,169,162,137,118,95,96,90,92,98,89,97},{115,109,108,105,95,47,57,68,51,81,152,148,101,162,200,227,227,220,219,197,191,209,206,208,192,118,89,95,95,97,89,92},{116,100,100,100,96,42,43,50,65,146,191,94,105,156,166,234,253,252,234,217,208,196,217,241,229,132,95,97,92,91,88,88},{115,95,97,99,87,40,59,69,121,204,182,90,133,157,188,226,237,233,224,217,181,137,193,241,216,142,127,129,123,116,95,82},{111,88,99,103,89,64,73,104,181,243,147,119,176,197,207,218,212,186,163,158,171,157,167,218,206,133,116,115,116,123,119,102},{114,75,80,90,91,83,58,154,226,243,134,132,214,218,169,160,146,119,116,124,157,195,198,221,212,125,85,81,83,86,105,128},{105,82,90,92,89,95,145,227,247,213,136,121,182,169,89,98,91,114,127,99,126,183,228,225,196,117,76,75,66,65,74,121},{104,80,86,85,86,102,196,232,199,173,129,104,146,145,86,102,106,131,108,94,113,150,183,171,175,124,72,81,88,92,82,119},{104,76,85,81,81,117,118,141,166,156,134,115,148,153,108,95,105,110,102,102,101,101,110,106,111,113,100,111,118,116,116,162},{102,80,89,87,90,111,91,97,136,136,151,160,157,131,108,97,101,106,110,108,104,105,104,102,96,103,126,135,133,122,136,184},{103,87,89,96,109,106,104,104,121,123,141,174,168,177,112,96,102,94,107,111,109,101,76,60,61,99,142,141,121,113,149,174},{107,80,88,99,104,109,112,117,131,145,124,168,197,175,165,144,106,82,97,112,109,74,43,50,73,117,134,116,99,121,165,132},{128,88,85,88,90,94,108,117,120,136,118,110,149,121,123,130,109,91,85,88,84,83,92,105,108,112,105,92,102,159,181,107},{157,129,100,79,76,88,98,106,106,99,87,82,109,121,99,88,87,108,106,90,95,110,113,107,112,105,93,90,131,183,155,86},{174,136,122,111,88,82,94,100,95,92,78,87,99,101,94,83,82,94,108,104,95,91,103,105,108,109,101,107,167,173,93,48},{182,150,148,139,120,103,100,108,105,98,88,92,102,101,89,82,81,88,100,104,101,78,85,101,107,112,101,87,155,144,29,19},{170,153,161,157,146,135,121,107,95,87,93,98,95,99,91,89,90,102,106,103,110,94,76,84,102,103,69,24,105,133,31,34},{139,123,144,153,158,164,153,137,118,99,97,97,92,93,91,91,95,99,98,96,93,84,80,72,81,67,31,5,94,148,62,53},{144,129,142,149,168,189,191,181,163,143,132,128,127,123,114,120,124,116,104,103,105,95,90,91,96,87,67,78,140,184,118,92}},
		{{63,45,43,42,52,63,75,80,89,93,77,76,91,86,79,71,79,76,64,78,75,69,74,77,89,100,108,102,104,108,102,103},{20,0,0,8,21,43,45,44,50,44,37,35,36,35,33,37,44,33,27,46,46,39,47,41,37,48,53,58,60,55,50,57},{21,0,8,23,41,54,55,47,43,44,46,45,38,48,47,56,56,51,43,47,54,55,62,51,49,50,53,68,58,50,50,42},{17,4,25,28,33,35,37,33,33,45,53,40,38,58,47,45,40,41,52,43,51,58,57,52,44,50,49,51,50,50,48,35},{21,11,34,39,36,36,40,39,34,49,51,31,33,42,39,29,23,37,49,41,50,66,58,66,51,45,41,40,32,27,23,25},{29,24,37,38,45,42,43,37,33,44,39,25,31,31,34,27,21,32,38,36,42,46,36,72,79,64,45,34,24,15,0,4},{40,36,43,38,44,40,30,31,46,54,34,39,34,14,17,17,21,23,16,19,18,31,83,80,79,69,49,36,29,37,38,30},{49,33,47,53,48,40,47,46,48,46,46,39,19,10,14,17,69,81,47,23,17,30,62,55,60,61,54,39,34,33,59,46},{68,41,51,48,44,43,44,44,40,54,53,20,16,16,18,15,56,62,71,49,27,24,24,22,36,59,58,49,48,43,45,56},{89,77,82,65,53,50,48,52,60,68,30,9,16,20,30,26,33,37,61,57,41,33,24,21,32,53,53,50,52,52,45,55},{94,82,82,70,64,66,68,66,81,68,13,17,17,30,57,49,54,37,46,57,76,106,53,26,25,41,45,51,57,55,46,57},{89,73,69,55,57,65,55,42,70,55,14,22,23,77,69,52,73,57,82,71,113,123,94,40,25,52,59,56,57,51,46,56},{86,69,68,64,74,65,34,33,44,23,19,59,41,98,122,99,110,115,118,91,97,88,76,50,38,51,61,60,57,52,48,56},{98,82,74,65,59,36,22,24,19,25,50,92,57,103,176,149,128,120,112,112,110,109,114,100,76,57,66,59,56,60,48,61},{79,66,68,65,62,21,32,40,26,45,113,107,51,121,170,196,186,165,163,144,139,157,164,181,156,78,57,62,60,60,50,56},{79,54,55,51,54,21,31,34,37,110,169,71,63,112,135,212,232,219,197,180,170,160,197,229,195,78,49,58,52,49,46,54},{79,49,51,51,49,21,41,37,75,166,157,56,84,110,156,208,226,215,201,192,152,100,154,216,173,78,60,62,55,46,30,40},{76,47,61,66,60,38,43,66,140,212,115,73,129,164,179,196,195,166,138,128,136,105,105,181,161,71,43,34,33,38,35,41},{80,37,48,57,56,48,32,138,212,229,104,88,177,195,142,131,115,85,79,83,110,141,152,197,176,63,16,13,13,16,27,54},{72,41,51,53,49,51,110,205,235,194,100,73,138,135,55,60,48,63,74,50,79,142,203,210,169,64,12,16,14,15,19,54},{66,38,49,46,45,59,161,210,186,151,92,55,96,105,47,58,59,78,54,45,67,112,160,147,146,86,26,34,43,50,36,50},{64,32,48,43,39,76,85,118,147,132,99,69,99,110,66,49,56,58,51,54,55,60,74,65,68,71,37,31,35,39,45,83},{65,35,46,44,50,71,52,61,104,107,118,120,113,89,65,53,52,57,61,61,59,59,59,60,48,39,30,14,8,10,44,102},{72,44,42,52,72,64,58,57,81,87,105,138,132,141,74,55,56,47,61,65,63,55,38,34,23,25,34,20,4,9,63,99},{74,37,48,59,63,62,67,78,96,107,84,133,168,148,133,107,64,40,52,66,61,29,14,25,33,47,39,31,24,42,91,75},{76,18,35,48,45,49,68,83,82,100,88,75,110,86,87,92,71,51,43,43,37,36,52,66,62,52,39,39,44,87,114,58},{82,26,25,34,41,49,53,56,58,63,59,44,60,77,59,51,52,70,65,48,50,63,65,63,67,54,44,46,70,106,91,48},{87,16,19,35,34,35,49,53,53,51,34,41,52,57,54,48,51,60,69,63,53,46,57,59,62,63,54,57,102,105,49,26},{91,22,24,28,26,30,51,75,73,57,38,47,62,60,51,49,51,52,60,65,60,36,41,55,61,68,59,46,98,87,9,9},{96,34,26,27,34,32,42,52,49,46,57,62,55,57,51,52,54,58,60,61,64,46,33,39,58,62,40,11,60,70,7,20},{96,42,30,25,34,36,32,32,38,38,49,56,52,52,51,53,58,60,60,56,43,33,38,29,39,30,11,0,57,94,34,34},{116,94,87,67,68,76,72,70,79,82,86,92,94,92,84,90,93,91,83,77,69,55,59,58,65,59,46,57,104,140,84,72}}};

	int i,j,k,l,m,n;
	const int inputSize=24;
    const int fieldSize=3;
    const int stride=1;
    const int zeroPadding=0;
    const int inputChannels=3;
    const int outputChannels=1;
    const int nbNeurons=(int)((inputSize-fieldSize+2*zeroPadding)/stride +1);

	double time;
	clock_t begin;
	clock_t end;

    //float weights[4][4] = { {0.03,0.02,0.04,0.01}, {0.02,0.03,0.03,0.02}, {0.02,0.05,0.02,0.01}, {0.01,0.01,0.03,0.05} };

    float weigths[3][3][64] = {{{  7.76161611e-01,  -2.48498544e-01,   1.60512999e-01,   8.50527585e-01,
     -1.34358436e-01,   2.22376049e-01,   1.81620896e-01,   1.52826503e-01,
      1.34166867e-01,   9.62008610e-02,   4.56986539e-02,  -1.08104669e-01,
      4.64021564e-01,   1.03624657e-01,   2.11331755e-01,  -4.68664974e-01,
      1.91000968e-01,   3.34794462e-01,   1.08155064e-01,   2.53502578e-01,
      3.68827283e-01,  -2.86423177e-01,   3.64328504e-01,  -1.82979569e-01,
     -2.24659115e-01,  -8.59970152e-02,   5.67903101e-01,  -8.84378314e-01,
      7.82794952e-02,  -6.15172535e-02,  -1.92909949e-02,  -2.99065948e-01,
      2.88093448e-01,  -1.81038007e-01,  -6.79351091e-01,  -6.99419677e-01,
     -2.35205591e-01,  -4.24594849e-01,  -1.15093899e+00,  -3.33046377e-01,
     -2.83903480e-02,   1.38027295e-01,  -4.25205976e-01,  -1.65925622e-01,
      5.33015616e-02,   5.24923921e-01,   1.47039250e-01,  -7.33614743e-01,
     -1.13636680e-01,   7.24750638e-01,   4.86624628e-01,   2.63595402e-01,
     -5.39344490e-01,   1.89281926e-01,   4.70552921e-01,   2.82166719e-01,
     -4.30119514e-01,  -4.59248364e-01,  -1.00340120e-01,  -8.12314510e-01,
      6.81686759e-01,   2.52034932e-01,   1.88880607e-01,   1.34451225e-01},
   { -3.75436038e-01,   1.29757226e-01,  -6.71234488e-01,  -8.19130465e-02,
      3.53851765e-01,   3.49978298e-01,  -4.88686204e-01,   2.69330323e-01,
      1.32539779e-01,   6.51805401e-02,   1.20083869e-01,   8.54424164e-02,
      6.05659820e-02,   3.90102684e-01,   3.14871728e-01,  -1.05442131e+00,
      5.90656042e-01,   4.77782935e-01,   1.03091255e-01,   1.40705064e-01,
     -5.70846140e-01,  -1.76538676e-02,  -5.82785547e-01,   2.10263386e-01,
      4.57562417e-01,   6.45783067e-01,   2.43667830e-02,  -9.18642059e-02,
      1.53875411e-01,  -3.87997597e-01,  -2.32485950e-01,   1.64460033e-01,
     -1.30670995e-01,   3.59582722e-01,  -2.16383234e-01,   3.62844169e-01,
      2.67562777e-01,   6.96346879e-01,   9.46552336e-01,   5.91474891e-01,
     -2.30942056e-01,   3.19015644e-02,  -1.37264520e-01,  -1.81452230e-01,
     -5.38357079e-01,   3.18798721e-01,  -4.11576331e-01,   1.46301255e-01,
     -5.57499766e-01,   6.85754776e-01,  -1.56995565e-01,   1.37383699e-01,
      5.07644236e-01,  -2.87918180e-01,  -1.15080583e+00,   2.66000718e-01,
     -8.29896051e-03,   1.87151015e-01,  -9.31538790e-02,   1.27310336e-01,
      2.33127564e-01,  -2.63439596e-01,   3.20874117e-02,   2.38248363e-01},
   { -5.90038419e-01,  -2.20828012e-01,   1.85186580e-01,  -7.65575230e-01,
      6.46746457e-01,  -6.80413187e-01,  -3.25711421e-03,  -1.30769327e-01,
     -1.07530113e-02,   5.58659136e-02,  -7.08921254e-01,   1.33266017e-01,
     -2.07169175e-01,   1.01410113e-01,   4.01673377e-01,  -1.15898693e+00,
     -2.47530147e-01,  -6.18088484e-01,   2.77952284e-01,  -4.11564648e-01,
     -4.96349752e-01,  -3.30113322e-01,   1.31404102e-01,   9.58177596e-02,
     -1.68185726e-01,  -8.22737575e-01,  -2.18517080e-01,   7.51179829e-02,
     -8.69018316e-01,  -1.81116894e-01,   1.33367315e-01,  -2.13091746e-01,
      6.15926012e-02,   1.07851341e-01,   7.93644905e-01,   6.12991571e-01,
      3.01920652e-01,  -4.16269749e-01,   1.37577012e-01,  -1.10169679e-01,
     -1.76870361e-01,  -3.77542704e-01,  -1.55226633e-01,  -5.77605426e-01,
     -3.84085029e-01,  -2.00456545e-01,   3.69627476e-01,   3.57097596e-01,
     -1.29326463e-01,   5.12910903e-01,   3.62121344e-01,  -1.05215229e-01,
      1.16793150e-02,  -6.66345954e-02,   7.71256208e-01,  -5.71562529e-01,
     -1.38562799e-01,  -2.64885813e-01,  -9.83139873e-02,   2.77395099e-01,
      2.54172564e-01,  -1.49430595e-02,   1.31984979e-01,  -3.15992177e-01}},

  {{  9.60672736e-01,   5.32902658e-01,   1.82326347e-01,  -7.35485926e-02,
     -2.27705017e-01,   2.01436713e-01,  -8.95649660e-03,   4.67083484e-01,
     -6.85884506e-02,  -6.39785826e-01,  -1.55492291e-01,   3.86742800e-02,
      9.14473295e-01,   4.10686314e-01,   1.70327917e-01,   7.59450257e-01,
     -6.61756039e-01,   3.74272764e-01,  -3.81361634e-01,   2.60740548e-01,
      2.94260502e-01,  -3.86789829e-01,   7.76772648e-02,  -3.05448174e-01,
     -1.24949954e-01,   7.50285625e-01,   6.76995516e-01,   1.09962547e+00,
     -2.43140578e-01,   7.38672912e-02,   6.72177613e-01,   5.47048271e-01,
     -9.28277075e-01,   2.75409043e-01,  -3.65742862e-01,   4.71677125e-01,
     -8.13470364e-01,  -2.49666333e-01,  -1.64769435e+00,  -1.26908195e+00,
     -9.56639722e-02,   6.28947020e-02,  -4.68298048e-01,   1.49155766e-01,
      2.01655835e-01,  -1.06976144e-01,   1.12327349e+00,  -5.27854383e-01,
     -7.51667693e-02,  -8.88901412e-01,  -1.95564672e-01,  -2.76372373e-01,
     -4.97104824e-01,   8.85807395e-01,   3.60117257e-01,  -2.05392405e-01,
      1.41184973e-02,  -3.91044199e-01,  -8.11052024e-02,  -8.29435170e-01,
     -1.34061500e-01,   8.72895718e-01,   2.39753649e-01,   3.33602965e-01},
   { -2.35546052e-01,   2.77748853e-01,  -9.75284800e-02,  -3.61909047e-02,
     -4.04979438e-02,   3.62943858e-01,  -1.09191529e-01,   4.26069826e-01,
      7.76030272e-02,   5.33522427e-01,   9.67009738e-02,  -5.36525905e-01,
      4.69916552e-01,  -3.02897543e-01,   1.60668850e-01,   2.24909082e-01,
     -5.00959575e-01,   2.97648817e-01,  -1.97794065e-01,   1.63773388e-01,
     -4.94411796e-01,  -1.01911688e+00,  -7.02163577e-01,  -5.20233288e-02,
      2.76713103e-01,   2.66480029e-01,  -8.59691296e-03,   1.99906215e-01,
      6.81091964e-01,   2.64081284e-02,   3.71331096e-01,   1.09643722e+00,
     -4.47812267e-02,   2.23103061e-01,  -4.29001719e-01,  -1.72720075e-01,
     -3.20626944e-01,   7.75874794e-01,   1.14361751e+00,   4.69817251e-01,
     -3.76006275e-01,  -3.39897454e-01,  -1.28815815e-01,  -2.49098599e-01,
      1.54276162e-01,  -1.34659708e-01,  -1.05381191e+00,   3.27905953e-01,
     -1.62469111e-02,  -1.15243769e+00,  -1.43943653e-02,  -7.58939803e-01,
      4.93636936e-01,  -6.58993661e-01,  -3.82907093e-01,  -1.21142909e-01,
      2.65080392e-01,   1.50004938e-01,  -3.20198715e-01,   1.78498000e-01,
     -4.10050124e-01,  -1.48561463e-01,   1.87041059e-01,  -9.63920131e-02},
   { -1.02304041e+00,   2.14483440e-01,   1.81453317e-01,   1.45611733e-01,
     -3.38225007e-01,  -5.69852173e-01,   1.79515891e-02,   2.16746598e-01,
     -6.56729102e-01,   4.22111183e-01,  -4.45417076e-01,  -4.30303905e-03,
     -5.12185514e-01,   3.55677873e-01,   4.11949188e-01,   2.78784391e-02,
     -7.40455925e-01,  -5.53836048e-01,   3.19318503e-01,  -3.40898514e-01,
     -3.20197403e-01,   3.47443849e-01,  -2.60100096e-01,   1.52353883e-01,
      3.72100681e-01,  -5.60707271e-01,  -5.20809218e-02,   3.22161168e-01,
     -3.67547393e-01,   4.39447910e-01,   1.14972457e-01,   1.51062489e-01,
     -3.98898989e-01,   5.77800095e-01,   4.11622018e-01,  -3.75474930e-01,
      1.21243801e-02,  -2.04587609e-01,   5.29292285e-01,   6.61590517e-01,
     -2.38518462e-01,   3.91001433e-01,  -5.95473424e-02,  -3.44650626e-01,
      6.48552850e-02,   2.68810302e-01,  -8.31648469e-01,   1.12196118e-01,
      5.64706624e-01,  -4.61417317e-01,  -6.17975771e-01,   1.88048214e-01,
     -3.14943977e-02,  -1.58291385e-01,   3.46839353e-02,   4.66801643e-01,
      2.62041658e-01,   7.41179613e-03,  -4.26963240e-01,   3.16649675e-01,
     -3.03269550e-02,   6.27339661e-01,  -6.51236922e-02,  -5.73934793e-01}},

  {{  5.01330853e-01,  -1.14559136e-01,  -3.64792466e-01,  -3.60680759e-01,
     -2.09404349e-01,   1.56536505e-01,  -1.29744604e-01,   1.35364801e-01,
     -4.56306458e-01,  -2.71533459e-01,   2.19290286e-01,   2.07431376e-01,
      7.02628016e-01,  -4.38615084e-01,  -1.04644291e-01,  -3.07850968e-02,
      4.36426699e-01,  -5.72431743e-01,  -1.03087336e-01,   4.54341531e-01,
      1.17766045e-01,   1.13421226e+00,  -3.29544172e-02,  -2.55522370e-01,
      3.79672438e-01,   7.02002347e-02,  -1.35271937e-01,  -5.50173521e-01,
     -1.47581100e-01,   5.78781627e-02,  -6.68457866e-01,  -5.59718966e-01,
     -1.64417997e-01,   9.08076577e-03,   2.50503689e-01,   1.00307655e+00,
      3.51903528e-01,  -2.79172927e-01,  -9.59753156e-01,   4.03979599e-01,
      2.22488455e-02,  -5.19331135e-02,  -3.76353085e-01,   7.40053535e-01,
      1.51055649e-01,  -5.44252157e-01,  -4.18166548e-01,   9.73225161e-02,
     -1.28041640e-01,   1.04387295e+00,  -1.26839459e-01,   3.25017005e-01,
     -6.07173502e-01,   2.04142421e-01,   5.50497055e-01,  -8.36751282e-01,
     -3.44051182e-01,   8.68117452e-01,  -7.49045908e-02,  -7.33813882e-01,
     -8.57287288e-01,  -1.23791896e-01,   5.31779289e-01,   2.85947531e-01},
   { -1.45647064e-01,  -1.38431922e-01,   4.18289959e-01,   1.18129097e-01,
      1.86355874e-01,   6.55830801e-01,  -2.07997873e-01,   5.82006931e-01,
      1.40560657e-01,   6.66349053e-01,  -2.14739263e-01,  -5.11870384e-01,
      4.13589925e-02,  -2.98726529e-01,  -1.77779660e-01,   4.58390355e-01,
      3.62615824e-01,   2.75018126e-01,   1.15465343e-01,   1.33331999e-01,
      9.03377077e-04,   2.97779649e-01,  -5.21559417e-01,   6.03706501e-02,
     -6.51767075e-01,   3.61036837e-01,  -6.36295080e-02,  -3.32743347e-01,
      2.77055502e-01,   4.29438084e-01,   5.67676350e-02,  -6.88454285e-02,
      1.21350622e+00,  -1.04266989e+00,  -2.30408356e-01,  -2.66690731e-01,
      8.09086263e-02,   2.88938761e-01,   8.79877865e-01,  -1.11357175e-01,
     -2.95652181e-01,  -3.25807571e-01,  -4.82368805e-02,  -2.69714832e-01,
      4.82096910e-01,  -5.26125968e-01,   4.66057092e-01,   1.32477984e-01,
     -4.66865629e-01,  -1.17039733e-01,   1.74472630e-01,   1.11710645e-01,
      1.20943761e+00,  -6.16601348e-01,  -1.46502197e+00,  -1.84567779e-01,
     -2.19721243e-01,   3.04644734e-01,  -1.73144415e-01,  -6.43757805e-02,
     -7.72365212e-01,  -2.42709979e-01,   5.65523446e-01,  -8.23019072e-05},
   { -9.90824044e-01,  -1.48276687e-01,  -3.62250239e-01,   2.94857174e-01,
      2.98288018e-01,  -7.35022664e-01,   3.23955238e-01,  -1.84891701e-01,
     -2.54315108e-01,  -2.64873207e-01,   5.19183338e-01,   9.57279205e-02,
     -7.11992204e-01,  -5.27525961e-01,   3.86652678e-01,  -7.58771151e-02,
      5.44695079e-01,   2.06998050e-01,   2.57141769e-01,  -4.70112234e-01,
      3.61549884e-01,   2.79776961e-01,  -4.75023806e-01,   4.94600683e-01,
     -3.17675591e-01,  -2.89018810e-01,  -1.23553127e-01,   1.16274588e-01,
      1.86852649e-01,   2.45654002e-01,  -3.09276879e-01,  -1.44187614e-01,
     -1.57076210e-01,  -4.35139090e-01,   2.77765870e-01,  -1.10522127e+00,
     -2.35151485e-01,  -2.64939129e-01,   1.35814101e-01,  -3.42437655e-01,
     -6.00076206e-02,   3.30372930e-01,  -9.67702419e-02,  -1.96080923e-01,
     -1.89625874e-01,   3.27185750e-01,   1.87714353e-01,   8.76308158e-02,
      1.16612092e-01,   8.04388165e-01,   7.90634155e-02,  -3.77079993e-02,
     -5.04665315e-01,   3.59725624e-01,   8.75133276e-01,   6.31069124e-01,
     -1.10618524e-01,  -1.21162541e-01,  -3.11918259e-01,   4.34763640e-01,
     -5.39720953e-01,   3.45025688e-01,  -1.60519481e-01,  -7.37369597e-01}}},


 {{{ -8.39314014e-02,   8.50490451e-01,   3.85195374e-01,   1.10835779e+00,
     -2.92097896e-01,  -3.74502093e-01,  -1.03811413e-01,   1.72141477e-01,
      1.46033943e-01,   5.38293600e-01,   2.06740186e-01,  -3.42795819e-01,
     -9.82701838e-01,   3.43194574e-01,  -6.27951801e-01,   1.11788310e-01,
     -7.34225154e-01,   1.64072290e-01,  -2.97290921e-01,  -2.79023871e-03,
      3.85548323e-01,   4.11924154e-01,  -7.95998350e-02,  -3.12559456e-02,
     -3.00638020e-01,   1.02340710e+00,   5.72679222e-01,  -5.95233083e-01,
     -5.23255020e-02,   4.41446118e-02,  -7.79995799e-01,  -4.54478621e-01,
      7.80953765e-01,  -2.91712970e-01,   2.02445865e-01,  -8.95194590e-01,
     -9.35130119e-01,  -2.54428506e-01,   5.81861973e-01,  -8.20958734e-01,
     -2.23566696e-01,   2.65160240e-02,   3.48954976e-01,  -2.08795398e-01,
     -1.51536584e-01,   2.80171096e-01,   3.46150607e-01,  -6.10858321e-01,
     -1.04617616e-02,  -3.26152146e-01,   1.35902181e-01,   1.54084321e-02,
      9.62105691e-01,  -3.68852407e-01,   3.47195379e-03,   6.35857761e-01,
     -5.02433300e-01,  -4.54378754e-01,   4.07426581e-02,  -3.62382203e-01,
     -7.85024315e-02,   3.70484889e-02,  -2.47100547e-01,  -6.85565770e-01},
   { -1.98174760e-01,   6.56847954e-01,  -4.40995336e-01,  -4.08877790e-01,
     -2.33131021e-01,  -5.48370063e-01,  -1.47920385e-01,   1.31161943e-01,
      4.76626679e-03,  -7.62621284e-01,   1.84426010e-01,   1.69315166e-03,
     -3.26390535e-01,  -3.30912739e-01,  -4.65652257e-01,  -1.58172667e-01,
     -3.69473398e-01,   1.79663718e-01,  -1.06662497e-01,   3.91394049e-02,
      8.28735888e-01,   1.05208087e+00,  -4.09567684e-01,   2.58130342e-01,
      4.63790983e-01,   5.69822609e-01,  -1.07324429e-01,   2.94342071e-01,
      3.93737346e-01,   1.77944973e-01,  -5.85602880e-01,  -2.05351993e-01,
     -3.36021721e-01,  -1.31838899e-02,   1.05070472e-01,   2.68303841e-01,
     -4.78039503e-01,   2.66509891e-01,  -1.06995851e-01,   2.67934829e-01,
     -1.38775287e-02,  -2.40255117e-01,   1.25734031e-01,   6.01991773e-01,
     -2.31250435e-01,   2.72105217e-01,  -3.09412092e-01,   8.07564378e-01,
     -1.29745647e-01,  -3.84858698e-02,  -2.36625560e-02,   8.62758398e-01,
     -1.46686268e+00,   4.93435562e-02,  -3.26102614e-01,   2.16670677e-01,
      1.57359131e-02,   6.81126416e-02,   3.72261286e-01,   2.90373266e-01,
     -1.28661335e-01,   2.02999607e-01,  -4.91280079e-01,   3.49493325e-01},
   {  3.43951970e-01,   4.21520531e-01,   9.16078806e-01,  -8.19815636e-01,
      3.98557514e-01,   1.01633596e+00,   8.56090635e-02,   9.66312177e-03,
      3.67716372e-01,  -5.82232893e-01,  -7.87472725e-01,   8.17951411e-02,
      7.39598989e-01,   3.65377128e-01,   5.60632586e-01,   3.98833066e-01,
     -7.10866570e-01,  -6.76821947e-01,   2.84636527e-01,  -5.39649371e-03,
      5.07831454e-01,  -8.45393538e-02,  -1.54830024e-01,  -3.44370026e-03,
     -7.12392777e-02,  -9.43199158e-01,   2.13039778e-02,  -4.14042860e-01,
     -5.65283656e-01,   4.23906714e-01,  -4.48011458e-01,  -2.17172161e-01,
      4.16211337e-01,  -3.39933485e-01,  -5.08899540e-02,   1.01104128e+00,
     -1.30691737e-01,  -1.44198433e-01,  -4.16877806e-01,   5.01062512e-01,
     -2.91021466e-01,   2.40867779e-01,   3.61072481e-01,   3.73241723e-01,
     -4.33666743e-02,   3.75701219e-01,  -2.61058003e-01,   6.87985539e-01,
     -2.78707981e-01,  -6.56589270e-01,   7.67194748e-01,   1.52717367e-01,
      3.59449893e-01,  -1.16981074e-01,   2.38495275e-01,  -6.49018228e-01,
     -2.14116052e-02,   8.41672793e-02,   4.06660616e-01,   2.03296810e-01,
     -6.42205179e-02,  -1.79008096e-01,  -2.05780342e-01,   4.71821934e-01}},

  {{  8.49607587e-02,  -9.07708168e-01,  -4.68360633e-02,  -6.78681195e-01,
      2.55590022e-01,  -3.70737493e-01,  -2.47648975e-04  -1.26542735e+00,
      6.81099355e-01,  -1.03413679e-01,   6.19207062e-02,   1.28259733e-01,
     -6.61480963e-01,  -7.79025495e-01,  -4.41616356e-01,   1.97218135e-01,
      1.14160645e+00,   2.65112638e-01,  -2.45277449e-01,  -6.45792484e-02,
      2.39898309e-01,  -6.39815748e-01,  -1.68126926e-01,  -7.97960311e-02,
     -1.50880620e-01,   4.75938506e-02,  -6.03342727e-02,   1.04877460e+00,
     -2.97589362e-01,   1.87879741e-01,   3.37664515e-01,  -1.23740114e-01,
      5.50057590e-01,   5.24069965e-02,   4.12026167e-01,  -2.67650217e-01,
      4.54048455e-01,  -5.47881722e-01,   3.20952535e-01,  -7.53788292e-01,
      1.97546855e-01,   2.35512387e-02,   6.58017024e-02,  -5.38976848e-01,
      2.46955976e-02,  -3.65637511e-01,   4.40421999e-01,   8.42338130e-02,
      2.70614713e-01,   3.63510758e-01,  -6.77410290e-02,  -6.04095817e-01,
      5.21602809e-01,   1.10905540e+00,  -8.44358742e-01,   1.58839837e-01,
     -7.30358899e-01,  -4.72836316e-01,   1.04609162e-01,  -4.58588868e-01,
      2.28624389e-01,   7.10067078e-02,  -5.01374424e-01,  -3.07364017e-01},
   { -7.70766437e-02,  -8.51032734e-01,  -3.38616192e-01,   1.11070881e-02,
      3.06193888e-01,  -3.59684050e-01,   1.03236184e-01,  -1.36560237e+00,
      1.24922022e-01,  -1.60889793e-02,  -4.31125462e-02,   2.21886169e-02,
     -1.89857572e-01,  -8.54053020e-01,  -5.09496033e-01,   3.39507818e-01,
      9.03808296e-01,  -2.29436100e-01,  -5.56389242e-02,   4.74885292e-02,
      3.95104438e-01,  -4.37285960e-01,   2.15648621e-01,   8.17479715e-02,
      3.32108259e-01,  -4.04974073e-01,  -7.01267943e-02,   4.31280643e-01,
      7.82101989e-01,   3.30681652e-01,  -9.77516174e-02,   1.90953672e-01,
      9.14848521e-02,   5.78370333e-01,   2.13261068e-01,  -1.16384581e-01,
     -1.26889735e-01,   1.20002292e-01,   1.23242545e-03,  -4.42939773e-02,
      3.34843248e-01,  -6.20182872e-01,   1.28590077e-01,  -5.93849309e-02,
      2.04506487e-01,  -3.41673434e-01,  -4.13799673e-01,   4.23467070e-01,
      5.31581044e-01,   5.72873175e-01,  -1.35969624e-01,  -7.78557062e-01,
     -1.06611109e+00,  -3.58787805e-01,   2.00035667e+00,  -2.60448307e-01,
     -1.05338089e-01,  -3.51264216e-02,   7.34841764e-01,   2.93688029e-01,
      2.18286831e-02,  -1.62231147e-01,  -3.58803958e-01,   1.27179429e-01},
   { -2.11967528e-01,  -3.12666774e-01,  -6.16052806e-01,   7.22914159e-01,
      3.46881628e-01,   9.76357043e-01,   2.05345452e-01,  -5.53850830e-01,
      1.26264140e-01,   3.10062051e-01,  -3.03854674e-01,   2.69494236e-01,
      4.70229805e-01,  -5.90186417e-01,  -4.73576896e-02,   6.00809395e-01,
      1.48498130e+00,  -6.61907196e-01,   4.49461699e-01,  -1.36012346e-01,
     -1.86260059e-01,   8.93208012e-02,   1.02060121e-02,  -8.60862955e-02,
      5.59054554e-01,   2.97558844e-01,   1.91789523e-01,   6.92141429e-02,
      5.01939833e-01,   3.34639162e-01,   5.63041925e-01,  -1.15355156e-01,
      4.47624743e-01,   5.54339170e-01,  -2.70483017e-01,   3.51312071e-01,
      1.07745364e-01,  -1.21441193e-01,  -3.01759452e-01,   7.44077027e-01,
      3.35990399e-01,   8.49242687e-01,   4.11609113e-01,  -5.55416718e-02,
      2.54916668e-01,   1.07258379e-01,  -4.17649537e-01,  -2.42646853e-03,
      5.19543350e-01,   3.66005868e-01,  -5.41666687e-01,  -1.97139665e-01,
      3.85661215e-01,  -3.97062600e-01,  -1.27104723e+00,   1.02461956e-01,
     -2.96710759e-01,   1.80854484e-01,   4.97205049e-01,   1.54857963e-01,
      4.85793769e-01,   7.80765191e-02,   1.57921091e-01,   4.78809536e-01}},

  {{ -2.36998945e-01,  -4.84563261e-02,  -3.92562687e-01,  -7.49755681e-01,
     -2.42232591e-01,  -2.12868825e-01,  -3.47914617e-03,   1.34789780e-01,
      1.36496693e-01,  -1.00403714e+00,   1.80319503e-01,   2.04997003e-01,
      6.67608440e-01,   3.51606578e-01,  -1.21874526e-01,  -6.24105871e-01,
     -5.51271737e-01,  -9.84289274e-02,   1.25596195e-01,   4.31026854e-02,
     -3.19206178e-01,  -2.67196327e-01,  -4.93190959e-02,  -9.14065167e-02,
      4.77470368e-01,  -2.55972445e-01,  -1.02909005e+00,  -4.67924386e-01,
     -1.78460732e-01,  -7.75025487e-02,   5.61712205e-01,  -2.29411811e-01,
     -1.11717439e+00,  -2.32459605e-01,   3.59467447e-01,   8.80717158e-01,
      7.70880401e-01,   1.17717050e-01,   2.53472626e-01,   1.16398036e+00,
     -2.54576862e-01,   6.12003691e-02,   4.72067520e-02,   2.89457321e-01,
     -1.19788498e-01,  -6.71028122e-02,  -1.03446269e+00,   4.22202677e-01,
      8.90363082e-02,   2.69086450e-01,  -1.12975985e-02,   2.12425634e-01,
     -3.66557568e-01,   5.19811869e-01,  -2.82413870e-01,  -6.87421322e-01,
     -2.30669796e-01,   6.81256294e-01,   1.24732025e-01,  -4.14800823e-01,
      5.00665605e-01,   5.26225790e-02,  -6.92254126e-01,  -1.32519871e-01},
   {  1.72998577e-01,   3.31506543e-02,   1.21986139e+00,   4.26982552e-01,
      1.61740556e-01,   4.47120611e-03,  -1.48252070e-01,   4.90492135e-02,
     -1.77327201e-01,   9.35278714e-01,  -3.36960256e-01,  -2.57189453e-01,
      1.68453440e-01,   1.06070960e+00,  -3.41527462e-01,   9.80788618e-02,
     -8.27348292e-01,   1.53600886e-01,  -1.27273455e-01,   9.80154648e-02,
      2.05945186e-02,  -9.74990368e-01,   5.45290768e-01,  -5.74391820e-02,
     -6.51707649e-01,  -2.38011092e-01,  -1.32892996e-01,  -1.10654451e-01,
     -4.55272734e-01,  -1.08412795e-01,   4.56548125e-01,  -1.65275857e-01,
      9.90664735e-02,  -2.93421298e-01,  -1.92705151e-02,  -1.90186888e-01,
      9.97857824e-02,   6.44135401e-02,  -1.63728058e-01,  -5.82443893e-01,
     -9.46531072e-02,  -4.46330905e-01,   1.04590222e-01,  -2.82025427e-01,
      2.14839637e-01,  -1.00420870e-01,   1.12457371e+00,  -3.42547476e-01,
     -2.09245220e-01,  -6.05833352e-01,   1.91030845e-01,   6.44876063e-01,
      6.31038845e-01,  -5.04218876e-01,   3.78403872e-01,  -1.74259275e-01,
      3.38188782e-02,  -1.72861218e-01,   7.24068522e-01,   9.01121870e-02,
     -6.49800822e-02,  -6.70856014e-02,  -7.24537075e-01,  -9.99592431e-03},
   {  1.66397199e-01,  -9.10729915e-02,  -3.72283220e-01,   3.62815440e-01,
      5.06182671e-01,   1.28087223e-01,  -7.58072187e-04  -5.35163749e-03,
     -8.78584087e-01,   8.81229997e-01,   2.66331106e-01,   4.73420918e-01,
     -3.21976304e-01,   1.99918717e-01,  -2.89283749e-02,  -7.26074725e-02,
     -3.81174594e-01,   1.32324368e-01,  -3.63823175e-01,  -9.13418755e-02,
      2.11920455e-01,   3.26001495e-01,   4.67592254e-02,   6.71600504e-03,
     -3.25132966e-01,   3.25805426e-01,   5.93109243e-02,  -3.03219318e-01,
      4.78769839e-01,  -4.70736593e-01,  -9.97348800e-02,  -1.28129795e-01,
     -7.08665729e-01,   3.70769389e-02,   4.06381860e-02,  -9.20610189e-01,
      8.24693367e-02,   2.50798047e-01,  -1.05889007e-01,  -3.03918183e-01,
      1.40190154e-01,   3.73602211e-01,   2.97531366e-01,  -5.38713075e-02,
      6.47297427e-02,  -2.44661018e-01,   6.73320591e-01,  -5.56879163e-01,
     -1.09566964e-01,  -2.92503655e-01,  -1.91087082e-01,   1.47529960e-01,
     -3.33553284e-01,  -2.19735518e-01,  -1.15406133e-01,   7.33080685e-01,
      6.90555125e-02,  -3.26769978e-01,   5.52241206e-01,   2.00050324e-01,
      1.08331695e-01,   6.29022121e-02,  -1.92151010e-01,   1.56939760e-01}}};

			       
    float tab1[outputChannels][nbNeurons][nbNeurons];

	//#pragma unroll_completely
    for(i=0;i<outputChannels;i++){
      	for(j=0;j<nbNeurons;j++){
      		for(k=0;k<nbNeurons;k++){
      			tab1[i][j][k] = 0;
      		}
       	}
    }

	begin = clock();

	//#pragma unroll_completely
    for(i=0;i<outputChannels;i++){
        for(j=0;j<nbNeurons;j++){
            	for(k=0;k<nbNeurons;k++){
                	for(l=0;l<fieldSize;l++){
                    		for(m=0;m<fieldSize;m++){
                        		for(n=0;n<inputChannels;n++){
                            			tab1[i][j][k]+=img[n][j*stride+l][k*stride+m]*weights[l][m][i]; // Add a dimension for output channels
     }}}}}}

    end = clock();
    time = (double)(end-begin)/(double)CLOCKS_PER_SEC;
    printf("execution time = %.*e s\n", 10, time);

/*
	//#pragma unroll_completely
    for(i=0;i<outputChannels;i++){
        for(j=0;j<nbNeurons;j++){
            	for(k=0;k<nbNeurons;k++){
            			printf("%f\n",tab1[i][j][k]);
    }}}
    //printf("nombre de valeurs = %d", count);
*/
    return 0;
}
